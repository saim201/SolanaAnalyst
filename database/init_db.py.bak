
import sys
from pathlib import Path

# Add parent directory to path for proper imports
sys.path.insert(0, str(Path(__file__).parent.parent))

from .config import engine, Base


def test_connection():
    try:
        with engine.connect() as conn:
            print("Database connection successful")
            return True
    except Exception as e:
        print(f"Database connection failed: {e}")
        return False


def init_db():
    from .models import PriceData, NewsData, CandlestickData

    print(f"DEBUG: Base.metadata.tables = {list(Base.metadata.tables.keys())}")
    Base.metadata.create_all(bind=engine)
    print("Database tables created successfully")


if __name__ == "__main__":

    test_connection()
    init_db()
